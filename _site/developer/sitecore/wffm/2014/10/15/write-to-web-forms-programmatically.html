<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=60f20c4f2d7d10a91e2a7d86006d2c546a8fcb2c" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.2.3 -->
<title>Write to Web Forms Programmatically | Mike Robbins</title>
<meta property="og:title" content="Write to Web Forms Programmatically" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Recently I had a requirement to capture a number of parameters from a users session and provide Sitecore administrators a way of reporting on this data and exporting the data to CSV for analysis. The reporting within WFFM was exactly what I was looking to achieve. I wondered if I could tap into this programmatically and use WFFM as my analysis and exporting tool. [caption id=&quot;attachment_256&quot; align=&quot;aligncenter&quot; width=&quot;300&quot; class=&quot; &quot;] Form Reports The idea is to create a new Form within WFFM and instead of adding the form to the page, instead create an instance of the form in memory, complete form and post the data into the WFFM database. Below is a code sample (commented) of completing the Form and posting the data back programmatically. &lt;br /&gt; public void SubmitToWFFM(ID formID, string username, string anotherString)&lt;br /&gt; {&lt;br /&gt; //Get form item by Item ID&lt;br /&gt; Sitecore.Forms.Core.Data.FormItem formItem = Sitecore.Forms.Core.Data.FormItem.GetForm(formID);&lt;/p&gt; &lt;p&gt;//Get form fields of the WFFM&lt;br /&gt; FieldItem[] formFields = formItem.Fields;&lt;/p&gt; &lt;p&gt;//Get all form fields of the form by name&lt;br /&gt; FieldItem usernameField = formFields .FirstOrDefault(x =&amp;amp;amp;gt; x.FieldDisplayName == &amp;amp;quot;Username&amp;amp;quot;);&lt;/p&gt; &lt;p&gt;FieldItem anotherField = loggingFields.FirstOrDefault(x =&amp;amp;gt; x.FieldDisplayName == &amp;amp;quot;AnotherField&amp;amp;quot;);&lt;/p&gt; &lt;p&gt;//Populate fields with values&lt;br /&gt; ControlResult controlUsernameTerm = new ControlResult(usernameField.Name, username, null);&lt;br /&gt; ControlResult controlAnotherField = new ControlResult(anotherField.Name, anotherString, null);&lt;/p&gt; &lt;p&gt;//Create collection of fields&lt;br /&gt; AdaptedControlResult[] acr = new AdaptedControlResult[2];&lt;br /&gt; acr[0] = new AdaptedControlResult(controlUsernameTerm, false);&lt;br /&gt; acr[1] = new AdaptedControlResult(controlAnotherField, true);&lt;/p&gt; &lt;p&gt;AdaptedResultList arl = new AdaptedResultList(acr);&lt;/p&gt; &lt;p&gt;//Save form&lt;br /&gt; SaveToDatabase dbSave = new SaveToDatabase();&lt;br /&gt; try&lt;br /&gt; {&lt;br /&gt; dbSave.Execute(formId, arl, null);&lt;/pre&gt;&lt;/p&gt; &lt;p&gt;catch (Exception ex)&lt;br /&gt; {&lt;br /&gt; Sitecore.Diagnostics.Log.Error(ex.Message, ex, this);&lt;br /&gt; }&lt;br /&gt; }&lt;br /&gt;" />
<meta property="og:description" content="Recently I had a requirement to capture a number of parameters from a users session and provide Sitecore administrators a way of reporting on this data and exporting the data to CSV for analysis. The reporting within WFFM was exactly what I was looking to achieve. I wondered if I could tap into this programmatically and use WFFM as my analysis and exporting tool. [caption id=&quot;attachment_256&quot; align=&quot;aligncenter&quot; width=&quot;300&quot; class=&quot; &quot;] Form Reports The idea is to create a new Form within WFFM and instead of adding the form to the page, instead create an instance of the form in memory, complete form and post the data into the WFFM database. Below is a code sample (commented) of completing the Form and posting the data back programmatically. &lt;br /&gt; public void SubmitToWFFM(ID formID, string username, string anotherString)&lt;br /&gt; {&lt;br /&gt; //Get form item by Item ID&lt;br /&gt; Sitecore.Forms.Core.Data.FormItem formItem = Sitecore.Forms.Core.Data.FormItem.GetForm(formID);&lt;/p&gt; &lt;p&gt;//Get form fields of the WFFM&lt;br /&gt; FieldItem[] formFields = formItem.Fields;&lt;/p&gt; &lt;p&gt;//Get all form fields of the form by name&lt;br /&gt; FieldItem usernameField = formFields .FirstOrDefault(x =&amp;amp;amp;gt; x.FieldDisplayName == &amp;amp;quot;Username&amp;amp;quot;);&lt;/p&gt; &lt;p&gt;FieldItem anotherField = loggingFields.FirstOrDefault(x =&amp;amp;gt; x.FieldDisplayName == &amp;amp;quot;AnotherField&amp;amp;quot;);&lt;/p&gt; &lt;p&gt;//Populate fields with values&lt;br /&gt; ControlResult controlUsernameTerm = new ControlResult(usernameField.Name, username, null);&lt;br /&gt; ControlResult controlAnotherField = new ControlResult(anotherField.Name, anotherString, null);&lt;/p&gt; &lt;p&gt;//Create collection of fields&lt;br /&gt; AdaptedControlResult[] acr = new AdaptedControlResult[2];&lt;br /&gt; acr[0] = new AdaptedControlResult(controlUsernameTerm, false);&lt;br /&gt; acr[1] = new AdaptedControlResult(controlAnotherField, true);&lt;/p&gt; &lt;p&gt;AdaptedResultList arl = new AdaptedResultList(acr);&lt;/p&gt; &lt;p&gt;//Save form&lt;br /&gt; SaveToDatabase dbSave = new SaveToDatabase();&lt;br /&gt; try&lt;br /&gt; {&lt;br /&gt; dbSave.Execute(formId, arl, null);&lt;/pre&gt;&lt;/p&gt; &lt;p&gt;catch (Exception ex)&lt;br /&gt; {&lt;br /&gt; Sitecore.Diagnostics.Log.Error(ex.Message, ex, this);&lt;br /&gt; }&lt;br /&gt; }&lt;br /&gt;" />
<link rel="canonical" href="http://localhost:4000/developer/sitecore/wffm/2014/10/15/write-to-web-forms-programmatically.html" />
<meta property="og:url" content="http://localhost:4000/developer/sitecore/wffm/2014/10/15/write-to-web-forms-programmatically.html" />
<meta property="og:site_name" content="Mike Robbins" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-10-15T08:56:04+01:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"BlogPosting","headline":"Write to Web Forms Programmatically","author":{"@type":"Person","name":null},"datePublished":"2014-10-15T08:56:04+01:00","dateModified":"2014-10-15T08:56:04+01:00","description":"Recently I had a requirement to capture a number of parameters from a users session and provide Sitecore administrators a way of reporting on this data and exporting the data to CSV for analysis. The reporting within WFFM was exactly what I was looking to achieve. I wondered if I could tap into this programmatically and use WFFM as my analysis and exporting tool. [caption id=&quot;attachment_256&quot; align=&quot;aligncenter&quot; width=&quot;300&quot; class=&quot; &quot;] Form Reports The idea is to create a new Form within WFFM and instead of adding the form to the page, instead create an instance of the form in memory, complete form and post the data into the WFFM database. Below is a code sample (commented) of completing the Form and posting the data back programmatically. &lt;br /&gt; public void SubmitToWFFM(ID formID, string username, string anotherString)&lt;br /&gt; {&lt;br /&gt; //Get form item by Item ID&lt;br /&gt; Sitecore.Forms.Core.Data.FormItem formItem = Sitecore.Forms.Core.Data.FormItem.GetForm(formID);&lt;/p&gt; &lt;p&gt;//Get form fields of the WFFM&lt;br /&gt; FieldItem[] formFields = formItem.Fields;&lt;/p&gt; &lt;p&gt;//Get all form fields of the form by name&lt;br /&gt; FieldItem usernameField = formFields .FirstOrDefault(x =&amp;amp;amp;gt; x.FieldDisplayName == &amp;amp;quot;Username&amp;amp;quot;);&lt;/p&gt; &lt;p&gt;FieldItem anotherField = loggingFields.FirstOrDefault(x =&amp;amp;gt; x.FieldDisplayName == &amp;amp;quot;AnotherField&amp;amp;quot;);&lt;/p&gt; &lt;p&gt;//Populate fields with values&lt;br /&gt; ControlResult controlUsernameTerm = new ControlResult(usernameField.Name, username, null);&lt;br /&gt; ControlResult controlAnotherField = new ControlResult(anotherField.Name, anotherString, null);&lt;/p&gt; &lt;p&gt;//Create collection of fields&lt;br /&gt; AdaptedControlResult[] acr = new AdaptedControlResult[2];&lt;br /&gt; acr[0] = new AdaptedControlResult(controlUsernameTerm, false);&lt;br /&gt; acr[1] = new AdaptedControlResult(controlAnotherField, true);&lt;/p&gt; &lt;p&gt;AdaptedResultList arl = new AdaptedResultList(acr);&lt;/p&gt; &lt;p&gt;//Save form&lt;br /&gt; SaveToDatabase dbSave = new SaveToDatabase();&lt;br /&gt; try&lt;br /&gt; {&lt;br /&gt; dbSave.Execute(formId, arl, null);&lt;/pre&gt;&lt;/p&gt; &lt;p&gt;catch (Exception ex)&lt;br /&gt; {&lt;br /&gt; Sitecore.Diagnostics.Log.Error(ex.Message, ex, this);&lt;br /&gt; }&lt;br /&gt; }&lt;br /&gt;","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/developer/sitecore/wffm/2014/10/15/write-to-web-forms-programmatically.html"},"url":"http://localhost:4000/developer/sitecore/wffm/2014/10/15/write-to-web-forms-programmatically.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://localhost:4000/">
          <h1>Mike Robbins</h1>
        </a>
        <h2>Sitecore Developer Blog
</h2>
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>Write to Web Forms Programmatically</h1>
          <p>Recently I had a requirement to capture a number of parameters from a users session and provide Sitecore administrators a way of reporting on this data and exporting the data to CSV for analysis.<!--more--></p>
<p>The reporting within WFFM was exactly what I was looking to achieve. I wondered if I could tap into this programmatically and use WFFM as my analysis and exporting tool.</p>
<p>[caption id="attachment_256" align="aligncenter"  class=" "]<a href="https://mikerobbinssitecore.files.wordpress.com/2014/10/wffm.png"><img class="size-medium wp-image-256" src="/assets/wffm.png" alt="Form Reports"  height="172" /></a> Form Reports</p>
<p>The idea is to create a new Form within WFFM and instead of adding the form to the page, instead create an instance of the form in memory, complete form and post the data into the WFFM database.</p>
<p>Below is a code sample (commented) of completing the Form and posting the data back programmatically.</p>
<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="p">&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">SubmitToWFFM</span><span class="p">(</span><span class="n">ID</span> <span class="n">formID</span><span class="p">,</span> <span class="kt">string</span> <span class="n">username</span><span class="p">,</span> <span class="kt">string</span> <span class="n">anotherString</span><span class="p">)&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="p">{&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="c1">//Get form item by Item ID&lt;br /&gt;
</span><span class="n">Sitecore</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">FormItem</span> <span class="n">formItem</span> <span class="p">=</span> <span class="n">Sitecore</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">FormItem</span><span class="p">.</span><span class="nf">GetForm</span><span class="p">(</span><span class="n">formID</span><span class="p">);&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="c1">//Get form fields of the WFFM&lt;br /&gt;
</span><span class="n">FieldItem</span><span class="p">[]</span> <span class="n">formFields</span> <span class="p">=</span> <span class="n">formItem</span><span class="p">.</span><span class="n">Fields</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="c1">//Get all form fields of the form by name&lt;br /&gt;
</span><span class="n">FieldItem</span> <span class="n">usernameField</span> <span class="p">=</span> <span class="n">formFields</span> <span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">x</span> <span class="p">=&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">gt</span><span class="p">;</span> <span class="n">x</span><span class="p">.</span><span class="n">FieldDisplayName</span> <span class="p">==</span> <span class="p">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;</span><span class="n">Username</span><span class="p">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;);&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="n">FieldItem</span> <span class="n">anotherField</span> <span class="p">=</span> <span class="n">loggingFields</span><span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">x</span> <span class="p">=&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">gt</span><span class="p">;</span> <span class="n">x</span><span class="p">.</span><span class="n">FieldDisplayName</span> <span class="p">==</span> <span class="p">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;</span><span class="n">AnotherField</span><span class="p">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;);&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="c1">//Populate fields with values&lt;br /&gt;
</span><span class="n">ControlResult</span> <span class="n">controlUsernameTerm</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ControlResult</span><span class="p">(</span><span class="n">usernameField</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="k">null</span><span class="p">);&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="n">ControlResult</span> <span class="n">controlAnotherField</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ControlResult</span><span class="p">(</span><span class="n">anotherField</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">anotherString</span><span class="p">,</span> <span class="k">null</span><span class="p">);&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="c1">//Create collection of fields&lt;br /&gt;
</span><span class="n">AdaptedControlResult</span><span class="p">[]</span> <span class="n">acr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">AdaptedControlResult</span><span class="p">[</span><span class="m">2</span><span class="p">];&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="n">acr</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AdaptedControlResult</span><span class="p">(</span><span class="n">controlUsernameTerm</span><span class="p">,</span> <span class="k">false</span><span class="p">);&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="n">acr</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AdaptedControlResult</span><span class="p">(</span><span class="n">controlAnotherField</span><span class="p">,</span> <span class="k">true</span><span class="p">);&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="n">AdaptedResultList</span> <span class="n">arl</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AdaptedResultList</span><span class="p">(</span><span class="n">acr</span><span class="p">);&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="c1">//Save form&lt;br /&gt;
</span><span class="n">SaveToDatabase</span> <span class="n">dbSave</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SaveToDatabase</span><span class="p">();&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="k">try</span><span class="p">&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="p">{&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="n">dbSave</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="n">formId</span><span class="p">,</span> <span class="n">arl</span><span class="p">,</span> <span class="k">null</span><span class="p">);&lt;/</span><span class="n">pre</span><span class="p">&gt;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="p">{&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="n">Sitecore</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="n">Log</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="k">this</span><span class="p">);&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="p">}&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="p">}&lt;</span><span class="n">br</span> <span class="p">/&gt;</span></code></pre></figure></p>

        </section>

        <aside id="sidebar">
          <h3>About Me</h3>
          <p>Senior Product Developer at Sitecore</p>
          <p>Sitecore MVP 2015 / 2016</p>
       
        <h3>Tags</h3>
        <p>
            
              developer,</li>
            
              Web Forms For Marketers,</li>
            
        </p>
    
        <h3>Other Reading</h3>
         
        <h2 id=""></h2>
        <ul class="post-list">
            
          
          
          
        </ul>
       
        <h2 id=""></h2>
        <ul class="post-list">
            
          
          
          
        </ul>
       
        <h2 id=""></h2>
        <ul class="post-list">
            
          
          
          
        </ul>
      

      <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
      
           </aside>

      </div>
    </div>

    
  </body>
</html>