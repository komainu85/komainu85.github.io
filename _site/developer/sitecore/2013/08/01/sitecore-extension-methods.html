<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=16767c114f45dae4d35b19539cb7a3826e5840d3" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.2.3 -->
<title>Sitecore extension methods | Mike Robbins</title>
<meta property="og:title" content="Sitecore extension methods" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Over the past year in my spare time I&#39;ve been building a code library for sitecore 6.X and Sitecore 7 more recently. I&#39;ve built up a big list of Sitecore extension methods so I thought I&#39;d share some of my favorites. Feel free to comment with your own. Sitecore 7 Indexing [code language=&quot;csharp&quot;] public static void AddItemToIndex(this Item item, string indexName) { var tempItem = (SitecoreIndexableItem)item; ContentSearchManager.GetIndex(indexName).Refresh(tempItem); } [/code] [code language=&quot;csharp&quot;] public static void UpdateItemInIndex(this Item item, string indexName) { var tempItem = (SitecoreIndexableItem)item; ContentSearchManager.GetIndex(indexName).Delete(tempItem.UniqueId); AddItemToIndex(item, indexName); } [/code] Sitecore Publishing [code language=&quot;csharp&quot;] public static void PublishItem(this Item item) { var publishOptions = new PublishOptions(item.Database, Database.GetDatabase(&quot;web&quot;), PublishMode.SingleItem, item.Language, DateTime.Now); // Create a publisher with the publishoptions var publisher = new Publisher(publishOptions); // Choose where to publish from publisher.Options.RootItem = item; // Publish children as well? publisher.Options.Deep = true; // Do the publish! publisher.Publish(); } [/code] [code language=&quot;csharp&quot;] public static void UnPublishItem(this Item item) { item.Publishing.UnpublishDate = DateTime.Now; PublishItem(item); }[/code] Sitecore Item Extensions [code language=&quot;csharp&quot;] public static string Url(this Item item) { return LinkManager.GetItemUrl(item); } [/code] [code language=&quot;csharp&quot;] public static IEnumerable&lt;Item&gt; ParentList(this Item item, Boolean descending = true) { if (item == null) return null; var parents = new List&lt;Item&gt;(); var currentItem = item.Parent; while (currentItem != null) { parents.Add(currentItem); currentItem = currentItem.Parent; } if (descending) parents.Reverse(); return parents; } [/code] [code language=&quot;csharp&quot;] public static bool IsDerivedFrom(this Item item, ID templateId) { if (item == null) return false; if (templateId.IsNull) return false; var templateItem = item.Database.Templates[templateId]; var returnValue = false; if (templateItem != null) { var template = TemplateManager.GetTemplate(item); returnValue = template != null &amp;&amp; template.ID == templateItem.ID || template.DescendsFrom(templateItem.ID); } return returnValue; } [/code] Sitecore Account Extensions [code language=&quot;csharp&quot;] public static MembershipUser GetMembershipUser(this Account account) { return Membership.GetUser(account.Name); } [/code]" />
<meta property="og:description" content="Over the past year in my spare time I&#39;ve been building a code library for sitecore 6.X and Sitecore 7 more recently. I&#39;ve built up a big list of Sitecore extension methods so I thought I&#39;d share some of my favorites. Feel free to comment with your own. Sitecore 7 Indexing [code language=&quot;csharp&quot;] public static void AddItemToIndex(this Item item, string indexName) { var tempItem = (SitecoreIndexableItem)item; ContentSearchManager.GetIndex(indexName).Refresh(tempItem); } [/code] [code language=&quot;csharp&quot;] public static void UpdateItemInIndex(this Item item, string indexName) { var tempItem = (SitecoreIndexableItem)item; ContentSearchManager.GetIndex(indexName).Delete(tempItem.UniqueId); AddItemToIndex(item, indexName); } [/code] Sitecore Publishing [code language=&quot;csharp&quot;] public static void PublishItem(this Item item) { var publishOptions = new PublishOptions(item.Database, Database.GetDatabase(&quot;web&quot;), PublishMode.SingleItem, item.Language, DateTime.Now); // Create a publisher with the publishoptions var publisher = new Publisher(publishOptions); // Choose where to publish from publisher.Options.RootItem = item; // Publish children as well? publisher.Options.Deep = true; // Do the publish! publisher.Publish(); } [/code] [code language=&quot;csharp&quot;] public static void UnPublishItem(this Item item) { item.Publishing.UnpublishDate = DateTime.Now; PublishItem(item); }[/code] Sitecore Item Extensions [code language=&quot;csharp&quot;] public static string Url(this Item item) { return LinkManager.GetItemUrl(item); } [/code] [code language=&quot;csharp&quot;] public static IEnumerable&lt;Item&gt; ParentList(this Item item, Boolean descending = true) { if (item == null) return null; var parents = new List&lt;Item&gt;(); var currentItem = item.Parent; while (currentItem != null) { parents.Add(currentItem); currentItem = currentItem.Parent; } if (descending) parents.Reverse(); return parents; } [/code] [code language=&quot;csharp&quot;] public static bool IsDerivedFrom(this Item item, ID templateId) { if (item == null) return false; if (templateId.IsNull) return false; var templateItem = item.Database.Templates[templateId]; var returnValue = false; if (templateItem != null) { var template = TemplateManager.GetTemplate(item); returnValue = template != null &amp;&amp; template.ID == templateItem.ID || template.DescendsFrom(templateItem.ID); } return returnValue; } [/code] Sitecore Account Extensions [code language=&quot;csharp&quot;] public static MembershipUser GetMembershipUser(this Account account) { return Membership.GetUser(account.Name); } [/code]" />
<link rel="canonical" href="http://localhost:4000/developer/sitecore/2013/08/01/sitecore-extension-methods.html" />
<meta property="og:url" content="http://localhost:4000/developer/sitecore/2013/08/01/sitecore-extension-methods.html" />
<meta property="og:site_name" content="Mike Robbins" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-08-01T07:28:52+01:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"BlogPosting","headline":"Sitecore extension methods","author":{"@type":"Person","name":null},"datePublished":"2013-08-01T07:28:52+01:00","dateModified":"2013-08-01T07:28:52+01:00","description":"Over the past year in my spare time I&#39;ve been building a code library for sitecore 6.X and Sitecore 7 more recently. I&#39;ve built up a big list of Sitecore extension methods so I thought I&#39;d share some of my favorites. Feel free to comment with your own. Sitecore 7 Indexing [code language=&quot;csharp&quot;] public static void AddItemToIndex(this Item item, string indexName) { var tempItem = (SitecoreIndexableItem)item; ContentSearchManager.GetIndex(indexName).Refresh(tempItem); } [/code] [code language=&quot;csharp&quot;] public static void UpdateItemInIndex(this Item item, string indexName) { var tempItem = (SitecoreIndexableItem)item; ContentSearchManager.GetIndex(indexName).Delete(tempItem.UniqueId); AddItemToIndex(item, indexName); } [/code] Sitecore Publishing [code language=&quot;csharp&quot;] public static void PublishItem(this Item item) { var publishOptions = new PublishOptions(item.Database, Database.GetDatabase(&quot;web&quot;), PublishMode.SingleItem, item.Language, DateTime.Now); // Create a publisher with the publishoptions var publisher = new Publisher(publishOptions); // Choose where to publish from publisher.Options.RootItem = item; // Publish children as well? publisher.Options.Deep = true; // Do the publish! publisher.Publish(); } [/code] [code language=&quot;csharp&quot;] public static void UnPublishItem(this Item item) { item.Publishing.UnpublishDate = DateTime.Now; PublishItem(item); }[/code] Sitecore Item Extensions [code language=&quot;csharp&quot;] public static string Url(this Item item) { return LinkManager.GetItemUrl(item); } [/code] [code language=&quot;csharp&quot;] public static IEnumerable&lt;Item&gt; ParentList(this Item item, Boolean descending = true) { if (item == null) return null; var parents = new List&lt;Item&gt;(); var currentItem = item.Parent; while (currentItem != null) { parents.Add(currentItem); currentItem = currentItem.Parent; } if (descending) parents.Reverse(); return parents; } [/code] [code language=&quot;csharp&quot;] public static bool IsDerivedFrom(this Item item, ID templateId) { if (item == null) return false; if (templateId.IsNull) return false; var templateItem = item.Database.Templates[templateId]; var returnValue = false; if (templateItem != null) { var template = TemplateManager.GetTemplate(item); returnValue = template != null &amp;&amp; template.ID == templateItem.ID || template.DescendsFrom(templateItem.ID); } return returnValue; } [/code] Sitecore Account Extensions [code language=&quot;csharp&quot;] public static MembershipUser GetMembershipUser(this Account account) { return Membership.GetUser(account.Name); } [/code]","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/developer/sitecore/2013/08/01/sitecore-extension-methods.html"},"url":"http://localhost:4000/developer/sitecore/2013/08/01/sitecore-extension-methods.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://localhost:4000/">
          <h1>Mike Robbins</h1>
        </a>
        <h2>Sitecore Developer Blog
</h2>
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>Sitecore extension methods</h1>
          <p>Over the past year in my spare time I've been building a code library for sitecore 6.X and Sitecore 7 more recently. I've built up a big list of Sitecore extension methods so I thought I'd share some of my favorites. Feel free to comment with your own.</p>
<h2></h2>
<h3>Sitecore 7 Indexing</h3>
<p>[code language="csharp"]<br />
public static void AddItemToIndex(this Item item, string indexName)<br />
{<br />
var tempItem = (SitecoreIndexableItem)item;</p>
<p>ContentSearchManager.GetIndex(indexName).Refresh(tempItem);</p>
<p>}<br />
[/code]</p>
<p>[code language="csharp"]<br />
public static void UpdateItemInIndex(this Item item, string indexName)<br />
{<br />
var tempItem = (SitecoreIndexableItem)item;</p>
<p>ContentSearchManager.GetIndex(indexName).Delete(tempItem.UniqueId);<br />
AddItemToIndex(item, indexName);<br />
}<br />
[/code]</p>
<h3>Sitecore Publishing</h3>
<p>[code language="csharp"]<br />
public static void PublishItem(this Item item)<br />
{<br />
var publishOptions = new PublishOptions(item.Database,<br />
Database.GetDatabase(&quot;web&quot;),<br />
PublishMode.SingleItem,<br />
item.Language,<br />
DateTime.Now); // Create a publisher with the publishoptions</p>
<p>var publisher = new Publisher(publishOptions);</p>
<p>// Choose where to publish from<br />
publisher.Options.RootItem = item;</p>
<p>// Publish children as well?<br />
publisher.Options.Deep = true;</p>
<p>// Do the publish!<br />
publisher.Publish();<br />
}<br />
[/code]</p>
<p>[code language="csharp"]<br />
public static void UnPublishItem(this Item item)<br />
{<br />
item.Publishing.UnpublishDate = DateTime.Now;<br />
PublishItem(item);<br />
}[/code]</p>
<h3>Sitecore Item Extensions</h3>
<p>[code language="csharp"]<br />
public static string Url(this Item item)<br />
{<br />
return LinkManager.GetItemUrl(item);<br />
}<br />
[/code]</p>
<p>[code language="csharp"]<br />
public static IEnumerable&lt;Item&gt; ParentList(this Item item, Boolean descending = true)<br />
{<br />
if (item == null)<br />
return null;<br />
var parents = new List&lt;Item&gt;();<br />
var currentItem = item.Parent;<br />
while (currentItem != null)<br />
{<br />
parents.Add(currentItem);<br />
currentItem = currentItem.Parent;<br />
}<br />
if (descending)<br />
parents.Reverse();<br />
return parents;<br />
}<br />
[/code]</p>
<p>[code language="csharp"]<br />
public static bool IsDerivedFrom(this Item item, ID templateId)<br />
{</p>
<p>if (item == null)<br />
return false;</p>
<p>if (templateId.IsNull)<br />
return false;</p>
<p>var templateItem = item.Database.Templates[templateId];</p>
<p>var returnValue = false;<br />
if (templateItem != null)<br />
{<br />
var template = TemplateManager.GetTemplate(item);</p>
<p>returnValue = template != null &amp;&amp; template.ID == templateItem.ID ||<br />
template.DescendsFrom(templateItem.ID);<br />
}</p>
<p>return returnValue;<br />
}<br />
[/code]</p>
<h3>Sitecore Account Extensions</h3>
<p>[code language="csharp"]<br />
public static MembershipUser GetMembershipUser(this Account account)<br />
{<br />
return Membership.GetUser(account.Name);<br />
}<br />
[/code]</p>

        </section>

        <aside id="sidebar">
          <h3>About Me</h3>
          <p>Senior Product Developer at Sitecore</p>
          <p>Sitecore MVP 2015 / 2016</p>
       
        <h3>Tags</h3>
        <p>
            
              developer,</li>
            
              extension methods,</li>
            
        </p>
    
        <h3>Other Reading</h3>
         
        <h2 id=""></h2>
        <ul class="post-list">
            
          
          
          
        </ul>
       
        <h2 id=""></h2>
        <ul class="post-list">
            
          
          
          
        </ul>
      

      <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
      
           </aside>

      </div>
    </div>

    
  </body>
</html>