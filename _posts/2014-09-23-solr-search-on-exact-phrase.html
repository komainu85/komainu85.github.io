---
layout: post
title: Solr Search On Exact Phrase
date: 2014-09-23 17:45:40.000000000 +01:00
type: post
published: true
status: publish
categories:
- Content Search
- Developer
- Sitecore
tags:
- developer
- Sitecore 7
- solr
meta:
  _edit_last: '53242770'
  geo_public: '0'
  _publicize_pending: '1'
  publicize_google_plus_url: https://plus.google.com/113240140771005714369/posts/TEpk5961uEw
  _wpas_done_5582732: '1'
  _publicize_done_external: a:1:{s:11:"google_plus";a:1:{s:21:"113240140771005714369";b:1;}}
  publicize_twitter_user: Sobek1985
  publicize_twitter_url: http://t.co/bI3AWWiocf
  _wpas_done_4473872: '1'
  publicize_linkedin_url: https://www.linkedin.com/updates?discuss=&scope=50486614&stype=M&topic=5920228594981830656&type=U&a=EcA4
  _wpas_done_5582720: '1'
  _wpas_skip_5582732: '1'
  _wpas_skip_4473872: '1'
  _wpas_skip_5582720: '1'
  _oembed_5b07fd0fa4fdf48a08beb17a1ffa2510: "{{unknown}}"
author:
  login: sobek1985
  email: sobek1985@gmail.com
  display_name: Mike Robbins
  first_name: ''
  last_name: ''
---
<p>Very brief code sample of how to perform a exact phrase match query in Solr.<!--more--></p>
<p>Using the Solr Admin's Query tool to perform a search on a field, you will notice that Solr splits each word into a token to search on.</p>
<p>[caption id="attachment_215" align="aligncenter" width="300" class=" "]<a href="https://mikerobbinssitecore.files.wordpress.com/2014/09/solr-phrase-match-1.png"><img class="wp-image-215 size-medium" src="{{ site.baseurl }}/assets/solr-phrase-match-1.png?w=300" alt="Solr Phrase Match 1" width="300" height="232" /></a> Solr Admin Query[/caption]</p>
<p>&nbsp;</p>
<p>Most of the time this is the desired functionality, however there could be times where you want to return results where the exact phrase is matched. If you perform a search wrapping quotes around the phrase within the Solr Admin Query tool, Solr will perform a query looking for an exact match on the phrase (see screenshot below, notice the reduced number of results).</p>
<p>&nbsp;</p>
<p>[caption id="attachment_216" align="aligncenter" width="300" class="  "]<a href="https://mikerobbinssitecore.files.wordpress.com/2014/09/solr-phrase-match-2.png"><img class="wp-image-216 size-medium" src="{{ site.baseurl }}/assets/solr-phrase-match-2.png?w=300" alt="Solr Phrase Match 2" width="300" height="230" /></a> Solr Admin Phase Search With Quotes[/caption]</p>
<p>&nbsp;</p>
<p>Below is a code sample of how to perform a search using Sitecore 7's Content Search API's. The code checks whether the keywords searched upon start and end with quotes. If the quotes are present, the keywords are then passed into the search intact with the quotes present. If the quotes aren't present the keywords are split into an array on a space and the search is performed as normal.</p>
<p>[code language="csharp"]<br />
private Expression&lt;Func&lt;SearchItem, bool&gt;&gt; GetKeywordFilters(string keywords)<br />
 {<br />
 var predicate = PredicateBuilder.True&lt;SearchItem&gt;();</p>
<p> var keywordCollection = new List&lt;string&gt;();</p>
<p> if (keywords.StartsWith(&quot;\&quot;&quot;) &amp;&amp; keywords.EndsWith(&quot;\&quot;&quot;))<br />
 {<br />
 keywordCollection.Add(keywords);<br />
 }<br />
 else<br />
 {<br />
 keywordCollection = keywords.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).ToList();<br />
 }</p>
<p> var filters = keywordCollection.Aggregate(predicate, (current, keyword) =&gt;<br />
current.Or(i =&gt; (i.Body.Equals(keyword)<br />
 || i.Title.Equals(keyword)<br />
);</p>
<p> return filters;<br />
 }<br />
[/code]</p>
<p>[code language="csharp"]<br />
public SearchResult&lt;SearchItem&gt; Search(string keywords)<br />
 {</p>
<p> using (var context = Sitecore.ContentSearch.ContentSearchManager.GetIndex(_searchIndex).CreateSearchContext())<br />
 {<br />
 var queryable = context.GetQueryable&lt;SearchItem&gt;();</p>
<p> Expression&lt;Func&lt;SearchItem, bool&gt;&gt; filters;</p>
<p> filters = GetKeywordFilters(keywords);<br />
 queryable = queryable.Where(filters);</p>
<p> var results = queryable.GetResults();<br />
 }[/code]</p>
